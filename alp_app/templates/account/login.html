{% load static %}
{% load widget_tweaks %}
{% load socialaccount %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sign In - Premium Experience</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    body {
      font-family: 'Poppins', sans-serif;
      overflow: hidden;
      opacity: 0;
      transition: opacity 0.8s ease;
    }

    body.fade-in { opacity: 1; }

    /* Glassmorphism Background */
    video#bgVideo {
      position: fixed;
      top: 0;
      left: 0;
      min-width: 100%;
      min-height: 100%;
      z-index: -1;
      object-fit: cover;
      filter: brightness(0.4) saturate(1.2);
    }

    /* Animations */
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(30px); filter: blur(10px); }
      to { opacity: 1; transform: translateY(0); filter: blur(0); }
    }

    @keyframes slideRight {
      from { opacity: 0; transform: translateX(-30px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .animate-slide-up { animation: slideUp 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards; }
    .animate-slide-right { animation: slideRight 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards; }

    /* Modern Input Styling */
    .input-group {
      position: relative;
      margin-bottom: 1.5rem;
    }

    .input-group input {
      border: none;
      border-bottom: 2px solid rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
      background: transparent !important;
    }

    .input-group input:focus {
      border-bottom-color: #eab308;
      box-shadow: 0 1px 0 0 #eab308;
    }

    /* Glass Card */
    .glass-panel {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    }

    /* Button Ripple */
    .btn-ripple {
      position: relative;
      overflow: hidden;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .btn-ripple:active { transform: scale(0.98); }

    .ripple {
      position: absolute;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.4);
      transform: scale(0);
      animation: ripple-animation 0.6s linear;
      pointer-events: none;
    }
    @keyframes ripple-animation {
      to { transform: scale(4); opacity: 0; }
    }

    form input, form button, form p, .social-icon { opacity: 0; }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">
  <div class="absolute top-4 left-4 md:top-8 md:left-8 z-50">
      <a href="/" class="group flex items-center gap-3">
          {# Logo Box #}
          <div class="p-1 border-2 border-gray-900 bg-white shadow-[3px_3px_0px_#eab308] 
                      transition-all duration-200 
                      group-hover:shadow-[0px_0px_0px_#eab308] 
                      group-hover:translate-x-[3px] 
                      group-hover:translate-y-[3px]">
              <img src="{% static 'img/1.jpeg' %}" alt="Logo" class="w-8 h-8 md:w-10 md:h-10 object-cover" />
          </div>

          {# Text Logo #}
          <div class="flex flex-col leading-none">
              <span class="text-xl md:text-2xl font-black text-gray-900 tracking-tighter select-none italic 
                          transition-colors duration-200 
                          group-hover:text-[#eab308]">
                  SSC<span class="hidden sm:inline"> Smart Study Club.</span>
              </span>
              {# Tambahan aksen industrial kecil di bawah teks #}
              <span class="text-[8px] font-black text-gray-400 tracking-[0.2em] uppercase mt-0.5">Digital Intelligence</span>
          </div>
      </a>
  </div>
  
  <video autoplay muted loop id="bgVideo" playsinline>
    <source src="{% static 'img/v1.mp4' %}" type="video/mp4" />
  </video>

  <div id="blurContainer" class="w-full max-w-6xl h-[600px] rounded-3xl overflow-hidden relative glass-panel flex opacity-0">
    <div id="welcomeSection" class="hidden md:flex w-1/2 flex-col justify-center px-16 bg-gradient-to-br from-black/40 to-transparent opacity-0">
      <div class="space-y-4">
        <span class="inline-block px-3 py-1 border-2 border-gray-900 bg-[#eab308] text-gray-900 text-xs font-black tracking-[0.2em] uppercase shadow-[3px_3px_0px_#000] -skew-x-12">
            Member Area
        </span>
        <h1 class="text-5xl font-bold text-white leading-tight">Welcome<br/><span class="text-[#eab308]">Back.</span></h1>
        <p class="text-gray-300 text-sm leading-relaxed max-w-xs">
          Nikmati kemudahan akses fitur premium kami. Masuk sekarang dan jelajahi cakrawala baru.
        </p>
      </div>
    </div>

    <div class="w-full md:w-1/2 bg-black/40 px-10 md:px-16 flex flex-col justify-center relative border-l border-white/10">
      
      <div class="flex items-start justify-between">
        <div class="w-full">
          <h2 id="signInTitle" class="text-white text-3xl font-semibold mb-8 opacity-0">Sign in</h2>
          
          <form method="POST" action="{% url 'account_login' %}" id="loginForm" class="space-y-4 opacity-0" novalidate>
            {% csrf_token %}

            <div class="input-group">
              <input type="text" id="username" name="login" placeholder="Username"
                value="{{ form.login.value|default:'' }}"
                class="w-full text-white placeholder-gray-500 py-3 focus:outline-none"
                required autocomplete="off" />
              {% if form.login.errors %}
                <p id="usernameError" class="text-red-400 text-[10px] mt-1 uppercase font-bold">{{ form.login.errors.0 }}</p>
              {% else %}
                <p id="usernameError" class="h-2">&nbsp;</p>
              {% endif %}
            </div>

            <div class="input-group">
              <input type="password" id="password" name="password" placeholder="Password"
                class="w-full text-white placeholder-gray-500 py-3 focus:outline-none"
                required autocomplete="new-password" />
              {% if form.password.errors %}
                <p id="passwordError" class="text-red-400 text-[10px] mt-1 uppercase font-bold">{{ form.password.errors.0 }}</p>
              {% else %}
                <p id="passwordError" class="h-2">&nbsp;</p>
              {% endif %}
            </div>

            <p id="loginError" class="text-red-400 text-xs text-center hidden"></p>

            <button type="submit"
              class="w-full bg-[#eab308] hover:bg-green-500 text-white font-semibold py-3.5 rounded-xl shadow-lg shadow-green-900/20 transition-all btn-ripple mt-4">
              Get Started
            </button>

            <p class="text-sm text-gray-400 text-center pt-4">
              New here? 
              <a href="{% url 'signup_view' %}" class="text-[#eab308] hover:underline transition">Create account</a>
            </p>
          </form>
        </div>

        <div id="dividerSocial" class="hidden lg:flex flex-row items-center ml-12 opacity-0">
          <div class="flex flex-col items-center mr-8">
            <div class="h-36 w-[1px] bg-gradient-to-b from-transparent to-white/30"></div>
            <span class="text-[11px] text-gray-400 my-4 font-bold tracking-widest uppercase">OR</span>
            <div class="h-36 w-[1px] bg-gradient-to-t from-transparent to-white/30"></div>
          </div>
          
          <div class="flex flex-col space-y-6">
            <a href="javascript:void(0)" onclick="featureUnderDevelopment(event)" class="social-icon bg-white/10 p-4 rounded-full hover:bg-white/20 transition-all border border-white/10 shadow-xl group flex items-center justify-center w-14 h-14">
              <svg class="w-6 h-6 text-white group-hover:scale-110 transition-transform" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
              </svg>
            </a>

            <a href="{% provider_login_url 'google' %}" class="social-icon bg-white/10 p-4 rounded-full hover:bg-white/20 transition-all border border-white/10 shadow-xl group flex items-center justify-center w-14 h-14">
              <svg class="w-6 h-6 group-hover:scale-110 transition-transform" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
                <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
                <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
                <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
              </svg>
            </a>

            <a href="javascript:void(0)" onclick="featureUnderDevelopment(event)" class="social-icon bg-white/10 p-4 rounded-full hover:bg-white/20 transition-all border border-white/10 shadow-xl group flex items-center justify-center w-14 h-14">
              <svg class="w-6 h-6 text-white group-hover:scale-110 transition-transform" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
              </svg>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    window.onload = function () {
      const usernameError = document.getElementById('usernameError'); 
      const passwordError = document.getElementById('passwordError');

      const hasError = (el) => el && el.textContent.trim() !== '' && el.textContent.trim() !== '\u00A0';

      if (hasError(usernameError) || hasError(passwordError)) {
        document.body.classList.add('fade-in');
        ['blurContainer', 'welcomeSection', 'signInTitle', 'loginForm', 'dividerSocial'].forEach(id => {
          const el = document.getElementById(id);
          if (el) el.style.opacity = '1';
        });
        document.querySelectorAll('input, button, p, .social-icon').forEach(el => el.style.opacity = '1');
        return;
      }

      // Normal Sequential Animation
      document.body.classList.add('fade-in');

      const blurContainer = document.getElementById('blurContainer');
      blurContainer.classList.add('animate-slide-up');
      blurContainer.style.opacity = '1';

      setTimeout(() => {
        const welcome = document.getElementById('welcomeSection');
        welcome.classList.add('animate-slide-right');
        welcome.style.opacity = '1';
      }, 400);

      setTimeout(() => {
        document.getElementById('signInTitle').classList.add('animate-slide-up');
      }, 700);

      setTimeout(() => {
        const form = document.getElementById('loginForm');
        form.style.opacity = '1';
        form.querySelectorAll('input, button, p').forEach((el, i) => {
          el.style.animation = `slideUp 0.6s cubic-bezier(0.22, 1, 0.36, 1) ${i * 0.1}s forwards`;
        });
      }, 900);

      setTimeout(() => {
        const social = document.getElementById('dividerSocial');
        social.style.opacity = '1';
        social.querySelectorAll('.social-icon').forEach((el, i) => {
          el.style.animation = `slideUp 0.5s ease forwards ${i * 0.1}s`;
        });
      }, 1400);
    };

    // Ripple effect
    document.addEventListener('click', function (e) {
      if (e.target.classList.contains('btn-ripple')) {
        const btn = e.target;
        const ripple = document.createElement('span');
        ripple.className = 'ripple';
        const rect = btn.getBoundingClientRect();
        const size = Math.max(rect.width, rect.height);
        ripple.style.width = ripple.style.height = size + 'px';
        ripple.style.left = e.clientX - rect.left - size/2 + 'px';
        ripple.style.top = e.clientY - rect.top - size/2 + 'px';
        btn.appendChild(ripple);
        ripple.addEventListener('animationend', () => ripple.remove());
      }
    });

    // Simple validation logic (remains as requested)
    const form = document.getElementById('loginForm');
    form.addEventListener('submit', function (e) {
      const u = document.getElementById('username').value.trim();
      const p = document.getElementById('password').value.trim();
      const err = document.getElementById('loginError');
      
      if (!u || !p) {
        e.preventDefault();
        err.textContent = 'Please fill in all fields.';
        err.classList.remove('hidden');
      }
    });

    // Pastikan fungsi ini didefinisikan secara global
    function featureUnderDevelopment(event) {
      if (event) {
          event.preventDefault();
          event.stopPropagation();
      }

      // Memastikan SweetAlert2 terdeteksi
      if (typeof Swal === 'undefined') {
          console.error("SweetAlert2 is missing!");
          return false;
      }

      Swal.fire({
          title: 'AKSES BELUM TERSEDIA',
          text: "Fitur ini sedang dalam tahap pengembangan dan akan segera diintegrasikan ke dalam sistem.",
          icon: 'warning',
          iconColor: '#eab308', // Kuning Emas sesuai tombol 'Create Account'
          showCancelButton: false,
          confirmButtonText: 'KONFIRMASI',
          
          // --- Styling Singkron dengan HTML Sign Up ---
          background: 'rgba(15, 15, 15, 0.9)', // Dark charcoal transparan
          backdrop: `rgba(0,0,0,0.8) blur(10px)`, // Blur yang lebih kuat sesuai tema glassmorphism
          color: '#ffffff',
          
          customClass: {
              // Border tipis sesuai class .glass-panel kamu
              popup: 'border border-white/10 backdrop-blur-2xl rounded-2xl shadow-2xl', 
              title: 'font-bold tracking-tighter uppercase text-2xl text-[#eab308]', 
              // Tombol kuning industrial konsisten dengan 'Create Account'
              confirmButton: 'bg-[#eab308] hover:bg-yellow-600 text-black font-extrabold py-3 px-12 rounded-xl transition-all uppercase tracking-widest text-xs shadow-[0_0_15px_rgba(234,179,8,0.3)]',
          },
          buttonsStyling: false,
      });
      return false;
  }
  </script>
</body>
</html>